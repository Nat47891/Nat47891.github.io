{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1><i class="fas fa-search"></i> ค้นหาจุดขายที่เหมาะสม</h1>
        
        <!-- ฟอร์มค้นหา -->
        <div class="search-form">
            <form method="GET" class="row g-3">
                <div class="col-md-6">
                    <label for="search" class="form-label">
                        <i class="fas fa-search"></i> ค้นหา
                    </label>
                    <input type="text" class="form-control" id="search" name="search" 
                           placeholder="ค้นหาชื่อตลาดหรือสถานที่" value="{{ request.args.get('search', '') }}">
                </div>
                <div class="col-md-4">
                    <label for="location" class="form-label">
                        <i class="fas fa-map-marker-alt"></i> พื้นที่
                    </label>
                    <select class="form-select" id="location" name="location">
                        <option value="">เลือกพื้นที่</option>
                        <option value="กรุงเทพฯ" {{ 'selected' if request.args.get('location') == 'กรุงเทพฯ' }}>กรุงเทพฯ</option>
                        <option value="ปทุมธานี" {{ 'selected' if request.args.get('location') == 'ปทุมธานี' }}>ปทุมธานี</option>
                        <option value="นนทบุรี" {{ 'selected' if request.args.get('location') == 'นนทบุรี' }}>นนทบุรี</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">&nbsp;</label>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-search"></i> ค้นหา
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- รายการสถานที่ -->
<div class="row">
    {% for space in spaces %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-store"></i> {{ space[1] }}</h5>
                <p class="card-text">
                    <strong><i class="fas fa-map-marker-alt"></i> สถานที่:</strong> {{ space[2] }}<br>
                    <strong><i class="fas fa-expand-arrows-alt"></i> ขนาด:</strong> {{ space[3] }}<br>
                    <strong><i class="fas fa-money-bill-wave"></i> ราคา:</strong> <span class="text-success">{{ space[4] }} บาท/วัน</span><br>
                    <strong><i class="fas fa-calendar"></i> วันที่เปิด:</strong> {{ space[5] }}<br>
                    <strong><i class="fas fa-clock"></i> เวลา:</strong> {{ space[6] }}
                </p>
                {% if session.user_id %}
                    <a href="{{ url_for('booking', space_id=space[0]) }}" class="btn btn-success w-100">
                        <i class="fas fa-shopping-cart"></i> จองเลย
                    </a>
                {% else %}
                    <a href="{{ url_for('login') }}" class="btn btn-outline-primary w-100">
                        <i class="fas fa-sign-in-alt"></i> เข้าสู่ระบบเพื่อจอง
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% if not spaces %}
<div class="empty-state">
    <div class="mb-4">
        <i class="fas fa-search-minus" style="font-size: 4rem; color: #cbd5e0;"></i>
    </div>
    <h4>ไม่พบสถานที่ที่ตรงกับการค้นหา</h4>
    <p>กรุณาลองใช้คำค้นหาอื่นหรือเปลี่ยนตัวกรอง</p>
</div>
{% endif %}
{% endblock %}